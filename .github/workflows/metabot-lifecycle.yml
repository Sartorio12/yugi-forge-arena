name: MetaBot Life Cycle

on:
  # schedule:
    # Roda a cada 4 horas (00:00, 04:00, 08:00, etc.)
    # - cron: '0 */4 * * *'
  workflow_dispatch: # Permite rodar manualmente pelo botão no GitHub

jobs:
  social_interaction:
    name: Social Routine (Comments)
    runs-on: ubuntu-latest
    steps:
      - name: Trigger Social API
        run: |
          TARGET_URL="${{ secrets.APP_URL }}/api/metabot-social"
          echo "Disparando Social Bot: $TARGET_URL"
          curl -X GET "$TARGET_URL" \
          -H "Authorization: Bearer ${{ secrets.CRON_SECRET }}" \
          --fail \
          --verbose

  news_reporting:
    name: News Routine (Journalist)
    needs: social_interaction # Roda depois do social para não sobrecarregar
    runs-on: ubuntu-latest
    steps:
      - name: Trigger News API
        run: |
          TARGET_URL="${{ secrets.APP_URL }}/api/metabot-news"
          echo "Disparando News Bot: $TARGET_URL"
          curl -X GET "$TARGET_URL" \
          -H "Authorization: Bearer ${{ secrets.CRON_SECRET }}" \
          --fail \
          --verbose